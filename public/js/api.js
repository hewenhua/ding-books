function userLogin(a,b){$("#submit").click(function(e){e.preventDefault();var d=$("#cellphone").val();var c=$("#password").val();var f={cellphone:d,password:c};$.ajax({type:"post",url:a,dataType:"json",data:f,success:function(g){if(g.result==0){$("#msg-box").text(g.msg);$("#msg-box").show()}else{if(g.result==1){$("#msg-box").removeClass("alert-error");$("#msg-box").addClass("alert-success");$("#msg-box").text(g.msg);$("#msg-box").show();window.location.href=b}else{$("#msg-box").text("connect error");$("#msg-box").show()}}},error:function(g){alert("connect error");console.log(g)}})})}function userRegister(a,b){$("#submit").click(function(f){f.preventDefault();var e=$("#cellphone").val();var d=$("#password").val();var c=$("#confirm").val();var g={cellphone:e,password:d,confirm:c};$.ajax({type:"post",url:a,dataType:"json",data:g,success:function(h){if(h.result==0){$("#msg-box").text(h.msg);$("#msg-box").show()}else{if(h.result==1){$("#msg-box").removeClass("alert-error");$("#msg-box").addClass("alert-success");$("#msg-box").text(h.msg);$("#msg-box").show();window.location.href=b}else{$("#msg-box").text("connect error");$("#msg-box").show()}}},error:function(h){alert("connect error");console.log(h)}})})}function shareBook(a){$("#submit").click(function(e){e.preventDefault();var b=$("#book_id").attr("book_id");var d=$("#description").val();var f={book_id:b,description:d};var c="这本书已经在漂中";var g=$("#another_one").html();$.ajax({type:"post",url:a,dataType:"json",data:f,success:function(h){if(h.result==0){dd.device.notification.alert({title:"闲书漂流",message:h.msg})}else{if(h.result==1){dd.device.notification.alert({title:"闲书漂流",message:c})}else{dd.device.notification.alert({title:"连接失败",message:c})}}},error:function(h){dd.device.notification.alert({title:"连接失败",message:c})}})})}function updateProfile(a){$("#submit").click(function(d){d.preventDefault();var f=$("#username").val();var c=$("#cellphone").val();var b=$("#email").val();var e={username:f,cellphone:c,email:b};$.ajax({type:"post",url:a,dataType:"json",data:e,success:function(g){if(g.result==0){$("#msg-box").text(g.msg);$("#msg-box").show()}else{if(g.result==1){$("#msg-box").removeClass("alert-error");$("#msg-box").addClass("alert-success");$("#msg-box").text("Profile changed success!");$("#msg-box").show();window.location.href=target_url}else{$("#msg-box").text("connect error");$("#msg-box").show()}}},error:function(g){alert("connect error");console.log(g)}})})}function updateItemDescription(a){$("#submit").click(function(d){d.preventDefault();var b=$("#item_id").attr("item_id");var c=$("#description").val();var e={item_id:b,description:c};$.ajax({type:"post",url:a,dataType:"json",data:e,success:function(f){if(f.result==0){$("#msg-box").text(f.msg);$("#msg-box").show()}else{if(f.result==1){$("#msg-box").removeClass("alert-error");$("#msg-box").addClass("alert-success");$("#msg-box").text("description changed success!");$("#msg-box").show();window.location.href=target_url}else{$("#msg-box").text("connect error");$("#msg-box").show()}}},error:function(f){alert("connect error");console.log(f)}})})}function updateItemStatus(a){$(".item_status").click(function(d){var c=$(this).attr("item_id");var b=0;if($(this).hasClass("share")){b=1}else{if($(this).hasClass("unshare")){b=2}else{b=3}}var e={item_id:c,status:b};$.ajax({type:"post",url:a,dataType:"json",data:e,success:function(f){if(f.result==0){dd.device.notification.alert({title:"闲书漂流",message:f.msg})}else{if(f.result==1){if(b==1){dd.device.notification.alert({title:"闲书漂流",message:"放漂成功！"})}else{if(b==2){dd.device.notification.alert({title:"闲书漂流",message:"收漂成功！"})}else{if(b==3){dd.device.notification.alert({title:"闲书漂流",message:"删除成功！"})}else{dd.device.notification.alert({title:"闲书漂流",message:"操作错误！"})}}}setTimeout("self.location.reload();",1000)}else{dd.device.notification.alert({title:"闲书漂流",message:"连接失败！"})}}},error:function(f){dd.device.notification.alert({title:"闲书漂流",message:"连接失败！"})}})})}function requestBorrow(a){$("#request").click(function(c){var b=$("#item_id").attr("item_id");var d={item_id:b};$.ajax({type:"post",url:a,dataType:"json",data:d,success:function(e){if(e.result==0){dd.device.notification.alert({title:"闲书漂流",message:e.msg})}else{if(e.result==1){dd.device.notification.alert({title:"闲书漂流",message:"求漂成功，等待对方回复"})}else{dd.device.notification.alert({title:"闲书漂流",message:"连接失败！"})}}},error:function(f){dd.device.notification.alert({title:"闲书漂流",message:"连接失败！"})}})})}function updateTrade(a){$(".trade_op").click(function(d){var c=$(this).attr("trade_id");var b=$(this).attr("trade_op");var e={trade_id:c,trade_op:b};$.ajax({type:"post",url:a,dataType:"json",data:e,success:function(f){if(f.result==0){dd.device.notification.alert({title:"闲书漂流",message:f.msg})}else{if(f.result==1){if(b=="accept"){dd.device.notification.alert({title:"闲书漂流",message:f.msg})}else{if(b=="deny"){dd.device.notification.alert({title:"闲书漂流",message:"你拒绝了求漂！"})}else{if(b=="cancel"){dd.device.notification.alert({title:"闲书漂流",message:f.msg})}else{if(b=="return"){dd.device.notification.alert({title:"闲书漂流",message:f.msg})}else{dd.device.notification.alert({title:"闲书漂流",message:"操作错误！"})}}}}setTimeout("self.location.reload();",1000)}else{dd.device.notification.alert({title:"闲书漂流",message:"连接失败！"})}}},error:function(f){dd.device.notification.alert({title:"闲书漂流",message:"连接失败！"})}})})};